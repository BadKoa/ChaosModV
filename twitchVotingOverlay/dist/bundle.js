!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);var o=function(){function e(){this.handlers=[]}return e.prototype.addEventListener=function(e){this.handlers.push(e)},e.prototype.removeEventListener=function(e){this.handlers=this.handlers.filter((function(t){return t!==e}))},e.prototype.dispatch=function(e){this.handlers.slice(0).forEach((function(t){return t(e)}))},e}(),r=function(){function e(e){this.createEvent=new o,this.updateEvent=new o,this.WS=null,this.URL=e,this.onSocketClose=this.onSocketClose.bind(this),this.onSocketError=this.onSocketError.bind(this),this.onSocketMessage=this.onSocketMessage.bind(this),this.onSocketOpen=this.onSocketOpen.bind(this),this.connect()}return e.prototype.addCreateVoteListener=function(e){this.createEvent.addEventListener(e)},e.prototype.addUpdateVoteListener=function(e){this.updateEvent.addEventListener(e)},e.prototype.removeCreateVoteListener=function(e){this.createEvent.removeEventListener(e)},e.prototype.removeUpdateVoteListener=function(e){this.updateEvent.removeEventListener(e)},e.prototype.connect=function(){try{this.WS=new WebSocket(this.URL),this.WS.addEventListener("close",this.onSocketClose),this.WS.addEventListener("error",this.onSocketError),this.WS.addEventListener("message",this.onSocketMessage),this.WS.addEventListener("open",this.onSocketOpen)}catch(e){}},e.prototype.onSocketError=function(e){console.log("error in socket occurred: "+e.message+". closing socket"),null!==this.WS&&this.WS.close()},e.prototype.onSocketClose=function(){var t=this;console.log("socket closed, reconnecting in "+e.RECONNECT_INTERVAL+"ms"),window.setTimeout((function(){return t.connect()}),e.RECONNECT_INTERVAL)},e.prototype.onSocketMessage=function(e){try{var t=JSON.parse(e.data);"CREATE"===t.request?this.createEvent.dispatch(t):"UPDATE"===t.request?this.updateEvent.dispatch(t):console.warn("unknown request type: "+t.request)}catch(e){console.error("failed to parse json data: "+e)}},e.prototype.onSocketOpen=function(){console.log("successfully connected to websocket")},e.RECONNECT_INTERVAL=1e3,e}(),i=function(){function e(t,n){this.bar=document.createElement("div"),this.barWrapper=document.createElement("div"),this.labelMatch=document.createElement("span"),this.labelWrapper=document.createElement("div"),this.labelText=document.createElement("span"),this.labelVotes=document.createElement("span"),this.bar.classList.add("bar"),this.barWrapper.classList.add("barWrapper"),this.labelWrapper.classList.add("labelWrapper"),this.matches=[],this.labelWrapper.append(this.labelMatch,this.labelText,this.labelVotes),this.barWrapper.append(this.labelWrapper),this.barWrapper.append(this.bar),this.bar.style.height=e.BAR_HEIGHT+"px",this.barWrapper.style.height=e.BAR_HEIGHT+"px",this.barWrapper.style.width=e.BAR_WIDTH+"px",this.label=t,this.votes=n}return e.prototype.getBarWrapper=function(){return this.barWrapper},Object.defineProperty(e.prototype,"label",{set:function(e){this.labelText.innerText=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"votes",{set:function(e){this.labelVotes.innerText=e.toString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"barWidth",{set:function(e){this.bar.style.width=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"matches",{set:function(e){this.labelMatch.innerText=e.join("/")+"."},enumerable:!1,configurable:!0}),e.BAR_WIDTH=350,e.BAR_HEIGHT=30,e}(),s=[],a=0,c=document.getElementById("barContainer"),l=document.getElementById("totalVotes"),p=new r("ws://localhost:9091");function u(e){s.forEach((function(e){return e.getBarWrapper().remove()})),s=e.voteOptions.map((function(e){return new i(e.label,e.value.toString())})),function(){if(null===c)throw new Error("could not find bar container in DOM");c.append.apply(c,s.map((function(e){return e.getBarWrapper()})))}(),a=e.totalVotes,h()}function h(){if(null===l)throw new Error("could not find total votes in DOM");l.innerText="Total Votes: "+a.toString()}p.addCreateVoteListener(u),p.addUpdateVoteListener((function(e){var t=e.voteOptions,n=e.totalVotes;s.length!==t.length?(console.error("bar amount is not equal to vote options length, treating as new vote"),u(e)):(t.forEach((function(t,o){var r=s[o],a=n>0?i.BAR_WIDTH/n*t.value:0;if("PERCENTAGE"===e.votingMode){var c=void 0;c=0===n?0:Math.floor(t.value/n*100),r.votes=c+"%"}else r.votes=t.value.toString();r.barWidth=a+"px",r.matches=t.matches})),a=n,h())}))}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2xpZ2h0RXZlbnQvbGlnaHRFdmVudC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvY2hhb3NXU0NsaWVudC9jaGFvc1dTQ2xpZW50LnRzIiwid2VicGFjazovLy8uL3NyYy9iYXJzLnRzIiwid2VicGFjazovLy8uL3NyYy9pbmRleC50cyJdLCJuYW1lcyI6WyJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiZXhwb3J0cyIsIm1vZHVsZSIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsImhhbmRsZXJzIiwiYWRkRXZlbnRMaXN0ZW5lciIsImhhbmRsZXIiLCJ0aGlzIiwicHVzaCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJmaWx0ZXIiLCJoIiwiZGlzcGF0Y2giLCJkYXRhIiwic2xpY2UiLCJmb3JFYWNoIiwiVVJMIiwiY3JlYXRlRXZlbnQiLCJMaXRlRXZlbnQiLCJ1cGRhdGVFdmVudCIsIldTIiwib25Tb2NrZXRDbG9zZSIsIm9uU29ja2V0RXJyb3IiLCJvblNvY2tldE1lc3NhZ2UiLCJvblNvY2tldE9wZW4iLCJjb25uZWN0IiwiYWRkQ3JlYXRlVm90ZUxpc3RlbmVyIiwibGlzdGVuZXIiLCJhZGRVcGRhdGVWb3RlTGlzdGVuZXIiLCJyZW1vdmVDcmVhdGVWb3RlTGlzdGVuZXIiLCJyZW1vdmVVcGRhdGVWb3RlTGlzdGVuZXIiLCJXZWJTb2NrZXQiLCJlIiwiZXJyb3IiLCJjb25zb2xlIiwibG9nIiwibWVzc2FnZSIsImNsb3NlIiwiQ2hhb3NXU0NsaWVudCIsIlJFQ09OTkVDVF9JTlRFUlZBTCIsIndpbmRvdyIsInNldFRpbWVvdXQiLCJNRVNTQUdFIiwiSlNPTiIsInBhcnNlIiwicmVxdWVzdCIsIndhcm4iLCJsYWJlbCIsInZvdGVzIiwiYmFyIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiYmFyV3JhcHBlciIsImxhYmVsTWF0Y2giLCJsYWJlbFdyYXBwZXIiLCJsYWJlbFRleHQiLCJsYWJlbFZvdGVzIiwiY2xhc3NMaXN0IiwiYWRkIiwibWF0Y2hlcyIsImFwcGVuZCIsInN0eWxlIiwiaGVpZ2h0IiwiQmFyIiwiQkFSX0hFSUdIVCIsIndpZHRoIiwiQkFSX1dJRFRIIiwiZ2V0QmFyV3JhcHBlciIsImlubmVyVGV4dCIsInRvU3RyaW5nIiwiam9pbiIsImJhcnMiLCJ0b3RhbFZvdGVzIiwiQkFSX0NPTlRBSU5FUiIsImdldEVsZW1lbnRCeUlkIiwiVE9UQUxfVk9URVMiLCJXU19DTElFTlQiLCJjcmVhdGVWb3RlIiwicmVtb3ZlIiwidm90ZU9wdGlvbnMiLCJtYXAiLCJ2b3RlT3B0aW9uIiwiRXJyb3IiLCJ1cGRhdGVCYXJDb250YWluZXIiLCJ1cGRhdGVUb3RhbFZvdGVzIiwibmV3VG90YWxWb3RlcyIsImxlbmd0aCIsImluZGV4Iiwidm90aW5nTW9kZSIsImJhclZhbHVlIiwiTWF0aCIsImZsb29yIiwiYmFyV2lkdGgiXSwibWFwcGluZ3MiOiJhQUNFLElBQUlBLEVBQW1CLEdBR3ZCLFNBQVNDLEVBQW9CQyxHQUc1QixHQUFHRixFQUFpQkUsR0FDbkIsT0FBT0YsRUFBaUJFLEdBQVVDLFFBR25DLElBQUlDLEVBQVNKLEVBQWlCRSxHQUFZLENBQ3pDRyxFQUFHSCxFQUNISSxHQUFHLEVBQ0hILFFBQVMsSUFVVixPQU5BSSxFQUFRTCxHQUFVTSxLQUFLSixFQUFPRCxRQUFTQyxFQUFRQSxFQUFPRCxRQUFTRixHQUcvREcs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ZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDApO1xuIiwiaW1wb3J0IHsgSUxpdGVFdmVudCB9IGZyb20gJy4vaUxpZ2h0RXZlbnQnO1xyXG5cclxuZXhwb3J0IGNsYXNzIExpdGVFdmVudDxUPiBpbXBsZW1lbnRzIElMaXRlRXZlbnQ8VD4ge1xyXG5cdHByaXZhdGUgaGFuZGxlcnM6ICgoZGF0YTogVCkgPT4gdm9pZClbXSA9IFtdO1xyXG5cclxuXHRwdWJsaWMgYWRkRXZlbnRMaXN0ZW5lcihoYW5kbGVyOiAoZGF0YTogVCkgPT4gdm9pZCk6IHZvaWQge1xyXG5cdFx0dGhpcy5oYW5kbGVycy5wdXNoKGhhbmRsZXIpO1xyXG5cdH1cclxuXHJcblx0cHVibGljIHJlbW92ZUV2ZW50TGlzdGVuZXIoaGFuZGxlcjogKGRhdGE6IFQpID0+IHZvaWQpOiB2b2lkIHtcclxuXHRcdHRoaXMuaGFuZGxlcnMgPSB0aGlzLmhhbmRsZXJzLmZpbHRlcihoID0+IGggIT09IGhhbmRsZXIpO1xyXG5cdH1cclxuXHJcblx0cHVibGljIGRpc3BhdGNoKGRhdGE6IFQpIHtcclxuXHRcdHRoaXMuaGFuZGxlcnMuc2xpY2UoMCkuZm9yRWFjaChoID0+IGgoZGF0YSkpO1xyXG5cdH1cclxufVxyXG4iLCJpbXBvcnQgeyBJQ2hhb3NXU0NsaWVudCB9IGZyb20gJy4vaUNoYW9zV1NDbGllbnQnO1xyXG5pbXBvcnQgeyBMaXRlRXZlbnQgfSBmcm9tICcuLi9saWdodEV2ZW50JztcclxuaW1wb3J0IHsgSVZvdGVPcHRpb24gfSBmcm9tICcuL2lWb3RlT3B0aW9uJztcclxuaW1wb3J0IHsgSU1lc3NhZ2UgfSBmcm9tICcuL2lNZXNzYWdlJztcclxuaW1wb3J0IHsgVE1lc3NhZ2VMaXN0ZW5lciB9IGZyb20gJy4vdE1lc3NhZ2VMaXN0ZW5lcic7XHJcblxyXG5leHBvcnQgY2xhc3MgQ2hhb3NXU0NsaWVudCBpbXBsZW1lbnRzIElDaGFvc1dTQ2xpZW50IHtcclxuXHRwdWJsaWMgc3RhdGljIFJFQ09OTkVDVF9JTlRFUlZBTCA9IDEwMDA7XHJcblxyXG5cdHByaXZhdGUgY3JlYXRlRXZlbnQgPSBuZXcgTGl0ZUV2ZW50PElNZXNzYWdlPigpO1xyXG5cdHByaXZhdGUgdXBkYXRlRXZlbnQgPSBuZXcgTGl0ZUV2ZW50PElNZXNzYWdlPigpO1xyXG5cclxuXHRwcml2YXRlIFdTOiBXZWJTb2NrZXQgfCBudWxsID0gbnVsbDtcclxuXHJcblx0cHJpdmF0ZSBVUkw6IHN0cmluZztcclxuXHJcblx0cHVibGljIGNvbnN0cnVjdG9yKFVSTDogc3RyaW5nKSB7XHJcblx0XHR0aGlzLlVSTCA9IFVSTDtcclxuXHJcblx0XHQvLyBCaW5kIHRoZSBsaXN0ZW5lciBtZXRob2RzXHJcblx0XHR0aGlzLm9uU29ja2V0Q2xvc2UgPSB0aGlzLm9uU29ja2V0Q2xvc2UuYmluZCh0aGlzKTtcclxuXHRcdHRoaXMub25Tb2NrZXRFcnJvciA9IHRoaXMub25Tb2NrZXRFcnJvci5iaW5kKHRoaXMpO1xyXG5cdFx0dGhpcy5vblNvY2tldE1lc3NhZ2UgPSB0aGlzLm9uU29ja2V0TWVzc2FnZS5iaW5kKHRoaXMpO1xyXG5cdFx0dGhpcy5vblNvY2tldE9wZW4gPSB0aGlzLm9uU29ja2V0T3Blbi5iaW5kKHRoaXMpO1xyXG5cclxuXHRcdHRoaXMuY29ubmVjdCgpO1xyXG5cdH1cclxuXHJcblx0cHVibGljIGFkZENyZWF0ZVZvdGVMaXN0ZW5lcihsaXN0ZW5lcjogVE1lc3NhZ2VMaXN0ZW5lcik6IHZvaWQge1xyXG5cdFx0dGhpcy5jcmVhdGVFdmVudC5hZGRFdmVudExpc3RlbmVyKGxpc3RlbmVyKTtcclxuXHR9XHJcblx0cHVibGljIGFkZFVwZGF0ZVZvdGVMaXN0ZW5lcihsaXN0ZW5lcjogVE1lc3NhZ2VMaXN0ZW5lcik6IHZvaWQge1xyXG5cdFx0dGhpcy51cGRhdGVFdmVudC5hZGRFdmVudExpc3RlbmVyKGxpc3RlbmVyKTtcclxuXHR9XHJcblx0cHVibGljIHJlbW92ZUNyZWF0ZVZvdGVMaXN0ZW5lcihsaXN0ZW5lcjogVE1lc3NhZ2VMaXN0ZW5lcik6IHZvaWQge1xyXG5cdFx0dGhpcy5jcmVhdGVFdmVudC5yZW1vdmVFdmVudExpc3RlbmVyKGxpc3RlbmVyKTtcclxuXHR9XHJcblx0cHVibGljIHJlbW92ZVVwZGF0ZVZvdGVMaXN0ZW5lcihsaXN0ZW5lcjogVE1lc3NhZ2VMaXN0ZW5lcik6IHZvaWQge1xyXG5cdFx0dGhpcy51cGRhdGVFdmVudC5yZW1vdmVFdmVudExpc3RlbmVyKGxpc3RlbmVyKTtcclxuXHR9XHJcblxyXG5cdHByaXZhdGUgY29ubmVjdCgpOiB2b2lkIHtcclxuXHRcdHRyeSB7XHJcblx0XHRcdHRoaXMuV1MgPSBuZXcgV2ViU29ja2V0KHRoaXMuVVJMKTtcclxuXHRcdFx0dGhpcy5XUy5hZGRFdmVudExpc3RlbmVyKCdjbG9zZScsIHRoaXMub25Tb2NrZXRDbG9zZSk7XHJcblx0XHRcdC8vIFwiYXMgYW55XCIgaXMgcmVxdWlyZWQgYmVjYXVzZSB0eXBlc2NyaXB0IHRoaW5rcyB0aGF0IHRoZSB3ZWJzb2NrZXQgXCJvbkVycm9yXCJcclxuXHRcdFx0Ly8gaGFzIGFuIGV2ZW50LCBhbmQgbm90IGFuZCBlcnJvciBhcyBjYWxsYmFjayBkYXRhXHJcblx0XHRcdHRoaXMuV1MuYWRkRXZlbnRMaXN0ZW5lcignZXJyb3InLCB0aGlzLm9uU29ja2V0RXJyb3IgYXMgYW55KTtcclxuXHRcdFx0dGhpcy5XUy5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgdGhpcy5vblNvY2tldE1lc3NhZ2UpO1xyXG5cdFx0XHR0aGlzLldTLmFkZEV2ZW50TGlzdGVuZXIoJ29wZW4nLCB0aGlzLm9uU29ja2V0T3Blbik7XHJcblx0XHR9IGNhdGNoIChlKSB7XHJcblx0XHRcdC8vIElmIHRoZSB3ZWJzb2NrZXQgY29ubmVjdGlvbiBmYWlscyB3ZSBnZXQgYW4gZXJyb3IsXHJcblx0XHRcdC8vIHRoaXMgaXMgY2F1Z2h0IGJ5IHRoZSBcIm9uRXJyb3JcIiBjYWxsYmFja1xyXG5cdFx0fVxyXG5cdH1cclxuXHRwcml2YXRlIG9uU29ja2V0RXJyb3IoZXJyb3I6IEVycm9yKTogdm9pZCB7XHJcblx0XHRjb25zb2xlLmxvZyhgZXJyb3IgaW4gc29ja2V0IG9jY3VycmVkOiAke2Vycm9yLm1lc3NhZ2V9LiBjbG9zaW5nIHNvY2tldGApO1xyXG5cdFx0aWYgKHRoaXMuV1MgIT09IG51bGwpIHRoaXMuV1MuY2xvc2UoKTtcclxuXHR9XHJcblx0cHJpdmF0ZSBvblNvY2tldENsb3NlKCk6IHZvaWQge1xyXG5cdFx0Y29uc29sZS5sb2coYHNvY2tldCBjbG9zZWQsIHJlY29ubmVjdGluZyBpbiAke0NoYW9zV1NDbGllbnQuUkVDT05ORUNUX0lOVEVSVkFMfW1zYCk7XHJcblxyXG5cdFx0d2luZG93LnNldFRpbWVvdXQoKCkgPT4gdGhpcy5jb25uZWN0KCksIENoYW9zV1NDbGllbnQuUkVDT05ORUNUX0lOVEVSVkFMKTtcclxuXHR9XHJcblx0cHJpdmF0ZSBvblNvY2tldE1lc3NhZ2UobWVzc2FnZTogTWVzc2FnZUV2ZW50KTogdm9pZCB7XHJcblx0XHR0cnkge1xyXG5cdFx0XHRjb25zdCBNRVNTQUdFOiBJTWVzc2FnZSA9IEpTT04ucGFyc2UobWVzc2FnZS5kYXRhKTtcclxuXHJcblx0XHRcdGlmIChNRVNTQUdFLnJlcXVlc3QgPT09ICdDUkVBVEUnKSB0aGlzLmNyZWF0ZUV2ZW50LmRpc3BhdGNoKE1FU1NBR0UpO1xyXG5cdFx0XHRlbHNlIGlmIChNRVNTQUdFLnJlcXVlc3QgPT09ICdVUERBVEUnKSB0aGlzLnVwZGF0ZUV2ZW50LmRpc3BhdGNoKE1FU1NBR0UpO1xyXG5cdFx0XHRlbHNlIGNvbnNvbGUud2FybihgdW5rbm93biByZXF1ZXN0IHR5cGU6ICR7TUVTU0FHRS5yZXF1ZXN0fWApO1xyXG5cdFx0fSBjYXRjaCAoZSkge1xyXG5cdFx0XHRjb25zb2xlLmVycm9yKGBmYWlsZWQgdG8gcGFyc2UganNvbiBkYXRhOiAke2V9YCk7XHJcblx0XHR9XHJcblx0fVxyXG5cdHByaXZhdGUgb25Tb2NrZXRPcGVuKCk6IHZvaWQge1xyXG5cdFx0Y29uc29sZS5sb2coJ3N1Y2Nlc3NmdWxseSBjb25uZWN0ZWQgdG8gd2Vic29ja2V0Jyk7XHJcblx0fVxyXG59XHJcbiIsImV4cG9ydCBjbGFzcyBCYXIge1xyXG5cdHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgQkFSX1dJRFRIID0gMzUwO1xyXG5cdHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgQkFSX0hFSUdIVCA9IDMwO1xyXG5cclxuXHRwcml2YXRlIGJhcjogSFRNTERpdkVsZW1lbnQ7XHJcblx0cHJpdmF0ZSBiYXJXcmFwcGVyOiBIVE1MRGl2RWxlbWVudDtcclxuXHRwcml2YXRlIGxhYmVsTWF0Y2g6IEhUTUxTcGFuRWxlbWVudDtcclxuXHRwcml2YXRlIGxhYmVsVGV4dDogSFRNTFNwYW5FbGVtZW50O1xyXG5cdHByaXZhdGUgbGFiZWxWb3RlczogSFRNTFNwYW5FbGVtZW50O1xyXG5cdHByaXZhdGUgbGFiZWxXcmFwcGVyOiBIVE1MRGl2RWxlbWVudDtcclxuXHJcblx0cHVibGljIGNvbnN0cnVjdG9yKGxhYmVsOiBzdHJpbmcsIHZvdGVzOiBzdHJpbmcpIHtcclxuXHRcdC8vIENyZWF0ZSBET00gZWxlbWVudHNcclxuXHRcdHRoaXMuYmFyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcblx0XHR0aGlzLmJhcldyYXBwZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuXHRcdHRoaXMubGFiZWxNYXRjaCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcclxuXHRcdHRoaXMubGFiZWxXcmFwcGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcblx0XHR0aGlzLmxhYmVsVGV4dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcclxuXHRcdHRoaXMubGFiZWxWb3RlcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcclxuXHRcdC8vIEFzc2lnbiBjbGFzc2VzXHJcblx0XHR0aGlzLmJhci5jbGFzc0xpc3QuYWRkKCdiYXInKTtcclxuXHRcdHRoaXMuYmFyV3JhcHBlci5jbGFzc0xpc3QuYWRkKCdiYXJXcmFwcGVyJyk7XHJcblx0XHR0aGlzLmxhYmVsV3JhcHBlci5jbGFzc0xpc3QuYWRkKCdsYWJlbFdyYXBwZXInKTtcclxuXHJcblx0XHR0aGlzLm1hdGNoZXMgPSBbXTtcclxuXHRcdC8vIEFzc2VtYmxlIHRoZSBiYXIgZWxlbWVudFxyXG5cdFx0dGhpcy5sYWJlbFdyYXBwZXIuYXBwZW5kKHRoaXMubGFiZWxNYXRjaCwgdGhpcy5sYWJlbFRleHQsIHRoaXMubGFiZWxWb3Rlcyk7XHJcblx0XHR0aGlzLmJhcldyYXBwZXIuYXBwZW5kKHRoaXMubGFiZWxXcmFwcGVyKTtcclxuXHRcdHRoaXMuYmFyV3JhcHBlci5hcHBlbmQodGhpcy5iYXIpO1xyXG5cclxuXHRcdHRoaXMuYmFyLnN0eWxlLmhlaWdodCA9IGAke0Jhci5CQVJfSEVJR0hUfXB4YDtcclxuXHRcdHRoaXMuYmFyV3JhcHBlci5zdHlsZS5oZWlnaHQgPSBgJHtCYXIuQkFSX0hFSUdIVH1weGA7XHJcblx0XHR0aGlzLmJhcldyYXBwZXIuc3R5bGUud2lkdGggPSBgJHtCYXIuQkFSX1dJRFRIfXB4YDtcclxuXHJcblx0XHQvLyBTZXQgdGhlIGxhYmVsIGNvbnRlbnRcclxuXHRcdHRoaXMubGFiZWwgPSBsYWJlbDtcclxuXHRcdHRoaXMudm90ZXMgPSB2b3RlcztcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBnZXRCYXJXcmFwcGVyKCk6IEhUTUxEaXZFbGVtZW50IHtcclxuXHRcdHJldHVybiB0aGlzLmJhcldyYXBwZXI7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgc2V0IGxhYmVsKGxhYmVsOiBzdHJpbmcpIHtcclxuXHRcdHRoaXMubGFiZWxUZXh0LmlubmVyVGV4dCA9IGxhYmVsO1xyXG5cdH1cclxuXHJcblx0cHVibGljIHNldCB2b3Rlcyh2b3Rlczogc3RyaW5nKSB7XHJcblx0XHR0aGlzLmxhYmVsVm90ZXMuaW5uZXJUZXh0ID0gdm90ZXMudG9TdHJpbmcoKTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBzZXQgYmFyV2lkdGgod2lkdGg6IHN0cmluZykge1xyXG5cdFx0dGhpcy5iYXIuc3R5bGUud2lkdGggPSB3aWR0aDtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBzZXQgbWF0Y2hlcyhtYXRjaGVzOiBzdHJpbmdbXSkge1xyXG5cdFx0dGhpcy5sYWJlbE1hdGNoLmlubmVyVGV4dCA9IG1hdGNoZXMuam9pbignLycpICsgJy4nO1xyXG5cdH1cclxufVxyXG4iLCJpbXBvcnQgeyBDaGFvc1dTQ2xpZW50IH0gZnJvbSAnLi9jaGFvc1dTQ2xpZW50L2NoYW9zV1NDbGllbnQnO1xyXG5pbXBvcnQgeyBCYXIgfSBmcm9tICcuL2JhcnMnO1xyXG5pbXBvcnQgeyBJTWVzc2FnZSB9IGZyb20gJy4vY2hhb3NXU0NsaWVudC9pTWVzc2FnZSc7XHJcblxyXG5sZXQgYmFyczogQmFyW10gPSBbXTtcclxubGV0IHRvdGFsVm90ZXMgPSAwO1xyXG5cclxuLy8gR2V0IERPTSBlbGVtZW50c1xyXG5jb25zdCBCQVJfQ09OVEFJTkVSID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2JhckNvbnRhaW5lcicpO1xyXG5jb25zdCBUT1RBTF9WT1RFUyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0b3RhbFZvdGVzJyk7XHJcblxyXG5jb25zdCBXU19DTElFTlQgPSBuZXcgQ2hhb3NXU0NsaWVudCgnd3M6Ly9sb2NhbGhvc3Q6OTA5MScpO1xyXG5cclxuV1NfQ0xJRU5ULmFkZENyZWF0ZVZvdGVMaXN0ZW5lcihjcmVhdGVWb3RlKTtcclxuV1NfQ0xJRU5ULmFkZFVwZGF0ZVZvdGVMaXN0ZW5lcih1cGRhdGVWb3RlKTtcclxuXHJcbmZ1bmN0aW9uIGNyZWF0ZVZvdGUobWVzc2FnZTogSU1lc3NhZ2UpOiB2b2lkIHtcclxuXHQvLyBSZW1vdmUgb2xkIGJhcnMgZnJvbSBET01cclxuXHRiYXJzLmZvckVhY2goYmFyID0+IGJhci5nZXRCYXJXcmFwcGVyKCkucmVtb3ZlKCkpO1xyXG5cdC8vIFVwZGF0ZSBiYXJzXHJcblx0YmFycyA9IG1lc3NhZ2Uudm90ZU9wdGlvbnMubWFwKFxyXG5cdFx0dm90ZU9wdGlvbiA9PiBuZXcgQmFyKHZvdGVPcHRpb24ubGFiZWwsIHZvdGVPcHRpb24udmFsdWUudG9TdHJpbmcoKSlcclxuXHQpO1xyXG5cdHVwZGF0ZUJhckNvbnRhaW5lcigpO1xyXG5cdC8vIFVwZGF0ZSB0aGUgdG90YWwgdm90ZXMgY291bnRlclxyXG5cdHRvdGFsVm90ZXMgPSBtZXNzYWdlLnRvdGFsVm90ZXM7XHJcblx0dXBkYXRlVG90YWxWb3RlcygpO1xyXG59XHJcblxyXG5mdW5jdGlvbiB1cGRhdGVWb3RlKG1lc3NhZ2U6IElNZXNzYWdlKTogdm9pZCB7XHJcblx0Y29uc3QgeyB2b3RlT3B0aW9ucywgdG90YWxWb3RlczogbmV3VG90YWxWb3RlcyB9ID0gbWVzc2FnZTtcclxuXHQvLyBDaGVjayBpZiB0aGUgbGVuZ3RoIG9mIHRoZSB2b3RlIG9wdGlvbnMgaXMgdGhlIHNhbWUgYXMgdGhlIGJhciBhbW91bnQuXHJcblx0Ly8gSWYgbm90LCBhbiBlcnJvciBvY3VycmVkIGFuZCB3ZSBqdXN0IHRyZWF0IHRoZSB1cGRhdGUgYXMgY3JlYXRlXHJcblx0aWYgKGJhcnMubGVuZ3RoICE9PSB2b3RlT3B0aW9ucy5sZW5ndGgpIHtcclxuXHRcdGNvbnNvbGUuZXJyb3IoYGJhciBhbW91bnQgaXMgbm90IGVxdWFsIHRvIHZvdGUgb3B0aW9ucyBsZW5ndGgsIHRyZWF0aW5nIGFzIG5ldyB2b3RlYCk7XHJcblx0XHRjcmVhdGVWb3RlKG1lc3NhZ2UpO1xyXG5cdH0gZWxzZSB7XHJcblx0XHR2b3RlT3B0aW9ucy5mb3JFYWNoKCh2b3RlT3B0aW9uLCBpbmRleCkgPT4ge1xyXG5cdFx0XHRjb25zdCBiYXIgPSBiYXJzW2luZGV4XTtcclxuXHRcdFx0Y29uc3QgQkFSX1dJRFRIID0gbmV3VG90YWxWb3RlcyA+IDAgPyAoQmFyLkJBUl9XSURUSCAvIG5ld1RvdGFsVm90ZXMpICogdm90ZU9wdGlvbi52YWx1ZSA6IDA7XHJcblxyXG5cdFx0XHRpZiAobWVzc2FnZS52b3RpbmdNb2RlID09PSAnUEVSQ0VOVEFHRScpIHtcclxuXHRcdFx0XHRsZXQgYmFyVmFsdWU6IG51bWJlcjtcclxuXHRcdFx0XHQvLyBXZSBjYW4ndCBkaXZpZGUgYnkgdG90YWwgdm90ZXMgaWYgaXQgaXMgbnVsbFxyXG5cdFx0XHRcdGlmIChuZXdUb3RhbFZvdGVzID09PSAwKSBiYXJWYWx1ZSA9IDA7XHJcblx0XHRcdFx0ZWxzZSBiYXJWYWx1ZSA9IE1hdGguZmxvb3IoKHZvdGVPcHRpb24udmFsdWUgLyBuZXdUb3RhbFZvdGVzKSAqIDEwMCk7XHJcblx0XHRcdFx0YmFyLnZvdGVzID0gYCR7YmFyVmFsdWV9JWA7XHJcblx0XHRcdH0gZWxzZSBiYXIudm90ZXMgPSB2b3RlT3B0aW9uLnZhbHVlLnRvU3RyaW5nKCk7XHJcblxyXG5cdFx0XHRiYXIuYmFyV2lkdGggPSBgJHtCQVJfV0lEVEh9cHhgO1xyXG5cdFx0XHRiYXIubWF0Y2hlcyA9IHZvdGVPcHRpb24ubWF0Y2hlcztcclxuXHRcdH0pO1xyXG5cdFx0Ly8gVXBkYXRlIHRvdGFsIHZvdGVzXHJcblx0XHR0b3RhbFZvdGVzID0gbmV3VG90YWxWb3RlcztcclxuXHRcdHVwZGF0ZVRvdGFsVm90ZXMoKTtcclxuXHR9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHVwZGF0ZUJhckNvbnRhaW5lcigpOiB2b2lkIHtcclxuXHRpZiAoQkFSX0NPTlRBSU5FUiA9PT0gbnVsbCkgdGhyb3cgbmV3IEVycm9yKCdjb3VsZCBub3QgZmluZCBiYXIgY29udGFpbmVyIGluIERPTScpO1xyXG5cdEJBUl9DT05UQUlORVIuYXBwZW5kKC4uLmJhcnMubWFwKGJhciA9PiBiYXIuZ2V0QmFyV3JhcHBlcigpKSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHVwZGF0ZVRvdGFsVm90ZXMoKTogdm9pZCB7XHJcblx0aWYgKFRPVEFMX1ZPVEVTID09PSBudWxsKSB0aHJvdyBuZXcgRXJyb3IoJ2NvdWxkIG5vdCBmaW5kIHRvdGFsIHZvdGVzIGluIERPTScpO1xyXG5cdFRPVEFMX1ZPVEVTLmlubmVyVGV4dCA9IGBUb3RhbCBWb3RlczogJHt0b3RhbFZvdGVzLnRvU3RyaW5nKCl9YDtcclxufVxyXG4iXSwic291cmNlUm9vdCI6IiJ9