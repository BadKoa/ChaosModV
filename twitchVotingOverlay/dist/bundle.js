!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);var o=function(){function e(){this.handlers=[]}return e.prototype.addEventListener=function(e){this.handlers.push(e)},e.prototype.removeEventListener=function(e){this.handlers=this.handlers.filter((function(t){return t!==e}))},e.prototype.dispatch=function(e){this.handlers.slice(0).forEach((function(t){return t(e)}))},e}(),r=function(){function e(e){this.WS=null,this.createEvent=new o,this.endEvent=new o,this.updateEvent=new o,this.URL=e,this.onSocketClose=this.onSocketClose.bind(this),this.onSocketError=this.onSocketError.bind(this),this.onSocketMessage=this.onSocketMessage.bind(this),this.onSocketOpen=this.onSocketOpen.bind(this),this.connect()}return e.prototype.addCreateVoteListener=function(e){this.createEvent.addEventListener(e)},e.prototype.addEndVoteListener=function(e){this.endEvent.addEventListener(e)},e.prototype.addUpdateVoteListener=function(e){this.updateEvent.addEventListener(e)},e.prototype.removeCreateVoteListener=function(e){this.createEvent.removeEventListener(e)},e.prototype.removeEndVoteListener=function(e){this.endEvent.removeEventListener(e)},e.prototype.removeUpdateVoteListener=function(e){this.updateEvent.removeEventListener(e)},e.prototype.connect=function(){try{this.WS=new WebSocket(this.URL),this.WS.addEventListener("close",this.onSocketClose),this.WS.addEventListener("error",this.onSocketError),this.WS.addEventListener("message",this.onSocketMessage),this.WS.addEventListener("open",this.onSocketOpen)}catch(e){}},e.prototype.onSocketError=function(e){console.log("error in socket occurred: "+e.message+". closing socket"),null!==this.WS&&this.WS.close()},e.prototype.onSocketClose=function(){var t=this;console.log("socket closed, reconnecting in "+e.RECONNECT_INTERVAL+"ms"),window.setTimeout((function(){return t.connect()}),e.RECONNECT_INTERVAL)},e.prototype.onSocketMessage=function(e){try{var t=JSON.parse(e.data);"CREATE"===t.request?this.createEvent.dispatch(t):"UPDATE"===t.request?this.updateEvent.dispatch(t):"END"===t.request?this.endEvent.dispatch(t):console.warn("unknown request type: "+t.request)}catch(e){console.error("failed to parse json data: "+e)}},e.prototype.onSocketOpen=function(){console.log("successfully connected to websocket")},e.RECONNECT_INTERVAL=1e3,e}(),i=function(){function e(t,n){this.bar=document.createElement("div"),this.barWrapper=document.createElement("div"),this.labelMatch=document.createElement("span"),this.labelWrapper=document.createElement("div"),this.labelText=document.createElement("span"),this.labelVotes=document.createElement("span"),this.bar.classList.add("bar"),this.barWrapper.classList.add("barWrapper"),this.labelWrapper.classList.add("labelWrapper"),this.matches=[],this.labelWrapper.append(this.labelMatch,this.labelText,this.labelVotes),this.barWrapper.append(this.labelWrapper),this.barWrapper.append(this.bar),this.bar.style.height=e.BAR_HEIGHT+"px",this.barWrapper.style.height=e.BAR_HEIGHT+"px",this.barWrapper.style.width=e.BAR_WIDTH+"px",this.label=t,this.votes=n}return e.prototype.getBarWrapper=function(){return this.barWrapper},Object.defineProperty(e.prototype,"label",{set:function(e){this.labelText.innerText=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"votes",{set:function(e){this.labelVotes.innerText=e.toString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"barWidth",{set:function(e){this.bar.style.width=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"matches",{set:function(e){this.labelMatch.innerText=e.join("/")+"."},enumerable:!1,configurable:!0}),e.BAR_WIDTH=350,e.BAR_HEIGHT=30,e}(),s=[],a=0,c=document.getElementById("barContainer"),l=document.getElementById("totalVotes"),p=new r("ws://localhost:9091");function u(e){s.forEach((function(e){return e.getBarWrapper().remove()})),s=e.voteOptions.map((function(e){return new i(e.label,e.value.toString())})),function(){if(null===c)throw new Error("could not find bar container in DOM");c.append.apply(c,s.map((function(e){return e.getBarWrapper()})))}(),a=e.totalVotes,d()}function d(){if(null===l)throw new Error("could not find total votes in DOM");l.innerText="Total Votes: "+a.toString()}p.addCreateVoteListener(u),p.addUpdateVoteListener((function(e){var t=e.voteOptions,n=e.totalVotes;s.length!==t.length?(console.error("bar amount is not equal to vote options length, treating as new vote"),u(e)):(t.forEach((function(t,o){var r=s[o],a=n>0?i.BAR_WIDTH/n*t.value:0;if("PERCENTAGE"===e.votingMode){var c=void 0;c=0===n?0:Math.floor(t.value/n*100),r.votes=c+"%"}else r.votes=t.value.toString();r.barWidth=a+"px",r.matches=t.matches})),a=n,d())})),p.addEndVoteListener((function(){return console.log("vote should have ended")}))}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2xpZ2h0RXZlbnQvbGlnaHRFdmVudC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvY2hhb3NPdmVybGF5Q2xpZW50L2NsaWVudC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvYmFycy50cyIsIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXgudHMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJoYW5kbGVycyIsImFkZEV2ZW50TGlzdGVuZXIiLCJoYW5kbGVyIiwidGhpcyIsInB1c2giLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZmlsdGVyIiwiaCIsImRpc3BhdGNoIiwiZGF0YSIsInNsaWNlIiwiZm9yRWFjaCIsIlVSTCIsIldTIiwiY3JlYXRlRXZlbnQiLCJMaXRlRXZlbnQiLCJlbmRFdmVudCIsInVwZGF0ZUV2ZW50Iiwib25Tb2NrZXRDbG9zZSIsIm9uU29ja2V0RXJyb3IiLCJvblNvY2tldE1lc3NhZ2UiLCJvblNvY2tldE9wZW4iLCJjb25uZWN0IiwiYWRkQ3JlYXRlVm90ZUxpc3RlbmVyIiwibGlzdGVuZXIiLCJhZGRFbmRWb3RlTGlzdGVuZXIiLCJhZGRVcGRhdGVWb3RlTGlzdGVuZXIiLCJyZW1vdmVDcmVhdGVWb3RlTGlzdGVuZXIiLCJyZW1vdmVFbmRWb3RlTGlzdGVuZXIiLCJyZW1vdmVVcGRhdGVWb3RlTGlzdGVuZXIiLCJXZWJTb2NrZXQiLCJlIiwiZXJyb3IiLCJjb25zb2xlIiwibG9nIiwibWVzc2FnZSIsImNsb3NlIiwiQ2hhb3NPdmVybGF5Q2xpZW50IiwiUkVDT05ORUNUX0lOVEVSVkFMIiwid2luZG93Iiwic2V0VGltZW91dCIsIk1FU1NBR0UiLCJKU09OIiwicGFyc2UiLCJyZXF1ZXN0Iiwid2FybiIsImxhYmVsIiwidm90ZXMiLCJiYXIiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJiYXJXcmFwcGVyIiwibGFiZWxNYXRjaCIsImxhYmVsV3JhcHBlciIsImxhYmVsVGV4dCIsImxhYmVsVm90ZXMiLCJjbGFzc0xpc3QiLCJhZGQiLCJtYXRjaGVzIiwiYXBwZW5kIiwic3R5bGUiLCJoZWlnaHQiLCJCYXIiLCJCQVJfSEVJR0hUIiwid2lkdGgiLCJCQVJfV0lEVEgiLCJnZXRCYXJXcmFwcGVyIiwiaW5uZXJUZXh0IiwidG9TdHJpbmciLCJqb2luIiwiYmFycyIsInRvdGFsVm90ZXMiLCJCQVJfQ09OVEFJTkVSIiwiZ2V0RWxlbWVudEJ5SWQiLCJUT1RBTF9WT1RFUyIsIldTX0NMSUVOVCIsImNyZWF0ZVZvdGUiLCJyZW1vdmUiLCJ2b3RlT3B0aW9ucyIsIm1hcCIsInZvdGVPcHRpb24iLCJFcnJvciIsInVwZGF0ZUJhckNvbnRhaW5lciIsInVwZGF0ZVRvdGFsVm90ZXMiLCJuZXdUb3RhbFZvdGVzIiwibGVuZ3RoIiwiaW5kZXgiLCJ2b3RpbmdNb2RlIiwiYmFyVmFsdWUiLCJNYXRoIiwiZmxvb3IiLCJiYXJXaWR0aCJdLCJtYXBwaW5ncyI6ImFBQ0UsSUFBSUEsRUFBbUIsR0FHdkIsU0FBU0MsRUFBb0JDLEdBRzVCLEdBQUdGLEVBQWlCRSxHQUNuQixPQUFPRixFQUFpQkUsR0FBVUMsUUFHbkMsSUFBSUMsRUFBU0osRUFBaUJFLEdBQVksQ0FDekNHLEVBQUdILEVBQ0hJLEdBQUcsRUFDSEgsUUFBUyxJQVVWLE9B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QXZCa0QsRUFBUW9ELFdBQTZCLENBQ3hDLElBQUlDLE9BQVEsRUFFYUEsRUFBSCxJQUFsQkosRUFBZ0MsRUFDcEJLLEtBQUtDLE1BQU9WLEVBQVcvRixNQUFRbUcsRUFBaUIsS0FDaEVwQyxFQUFJRCxNQUFXeUMsRUFBUSxTQUNqQnhDLEVBQUlELE1BQVFpQyxFQUFXL0YsTUFBTW1GLFdBRXBDcEIsRUFBSTJDLFNBQWMxQixFQUFTLEtBQzNCakIsRUFBSVUsUUFBVXNCLEVBQVd0QixXQUcxQmEsRUFBYWEsRUFDYkQsUUF4Q0ZSLEVBQVVsRCxvQkFBbUIsV0FBTSxPQUFBUSxRQUFRQyxJQUFJIiwiZmlsZSI6ImJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAwKTtcbiIsImltcG9ydCB7IElMaXRlRXZlbnQgfSBmcm9tICcuL2lMaWdodEV2ZW50JztcclxuXHJcbmV4cG9ydCBjbGFzcyBMaXRlRXZlbnQ8VD4gaW1wbGVtZW50cyBJTGl0ZUV2ZW50PFQ+IHtcclxuXHRwcml2YXRlIGhhbmRsZXJzOiAoKGRhdGE6IFQpID0+IHZvaWQpW10gPSBbXTtcclxuXHJcblx0cHVibGljIGFkZEV2ZW50TGlzdGVuZXIoaGFuZGxlcjogKGRhdGE6IFQpID0+IHZvaWQpOiB2b2lkIHtcclxuXHRcdHRoaXMuaGFuZGxlcnMucHVzaChoYW5kbGVyKTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyByZW1vdmVFdmVudExpc3RlbmVyKGhhbmRsZXI6IChkYXRhOiBUKSA9PiB2b2lkKTogdm9pZCB7XHJcblx0XHR0aGlzLmhhbmRsZXJzID0gdGhpcy5oYW5kbGVycy5maWx0ZXIoaCA9PiBoICE9PSBoYW5kbGVyKTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBkaXNwYXRjaChkYXRhOiBUKSB7XHJcblx0XHR0aGlzLmhhbmRsZXJzLnNsaWNlKDApLmZvckVhY2goaCA9PiBoKGRhdGEpKTtcclxuXHR9XHJcbn1cclxuIiwiaW1wb3J0IHsgSUNoYW9zT3ZlcmxheUNsaWVudCB9IGZyb20gJy4vaUNsaWVudCc7XHJcbmltcG9ydCB7IExpdGVFdmVudCB9IGZyb20gJy4uL2xpZ2h0RXZlbnQnO1xyXG5pbXBvcnQgeyBJQ2hhb3NPdmVybGF5Vm90ZU9wdGlvbiB9IGZyb20gJy4vaVZvdGVPcHRpb24nO1xyXG5pbXBvcnQgeyBJQ2hhb3NPdmVybGF5Q2xpZW50TWVzc2FnZSB9IGZyb20gJy4vaU1lc3NhZ2UnO1xyXG5pbXBvcnQgeyBUQ2hhb3NPdmVybGF5Q2xpZW50RXZlbnQgfSBmcm9tICcuL3RFdmVudCc7XHJcblxyXG5leHBvcnQgY2xhc3MgQ2hhb3NPdmVybGF5Q2xpZW50IGltcGxlbWVudHMgSUNoYW9zT3ZlcmxheUNsaWVudCB7XHJcblx0LyoqXHJcblx0ICogSW50ZXJ2YWwgaW4gd2hpY2ggdGhlIHdlYnNvY2tldCBjbGllbnQgdHJpZXMgdG8gcmVjb25uZWN0IHRvXHJcblx0ICogdGhlIHNlcnZlclxyXG5cdCAqL1xyXG5cdHB1YmxpYyBzdGF0aWMgUkVDT05ORUNUX0lOVEVSVkFMID0gMTAwMDtcclxuXHJcblx0cHJpdmF0ZSBVUkw6IHN0cmluZztcclxuXHRwcml2YXRlIFdTOiBXZWJTb2NrZXQgfCBudWxsID0gbnVsbDtcclxuXHRwcml2YXRlIGNyZWF0ZUV2ZW50ID0gbmV3IExpdGVFdmVudDxJQ2hhb3NPdmVybGF5Q2xpZW50TWVzc2FnZT4oKTtcclxuXHRwcml2YXRlIGVuZEV2ZW50ID0gbmV3IExpdGVFdmVudDxJQ2hhb3NPdmVybGF5Q2xpZW50TWVzc2FnZT4oKTtcclxuXHRwcml2YXRlIHVwZGF0ZUV2ZW50ID0gbmV3IExpdGVFdmVudDxJQ2hhb3NPdmVybGF5Q2xpZW50TWVzc2FnZT4oKTtcclxuXHJcblx0cHVibGljIGNvbnN0cnVjdG9yKFVSTDogc3RyaW5nKSB7XHJcblx0XHR0aGlzLlVSTCA9IFVSTDtcclxuXHJcblx0XHQvLyBCaW5kIHRoZSBsaXN0ZW5lciBtZXRob2RzXHJcblx0XHR0aGlzLm9uU29ja2V0Q2xvc2UgPSB0aGlzLm9uU29ja2V0Q2xvc2UuYmluZCh0aGlzKTtcclxuXHRcdHRoaXMub25Tb2NrZXRFcnJvciA9IHRoaXMub25Tb2NrZXRFcnJvci5iaW5kKHRoaXMpO1xyXG5cdFx0dGhpcy5vblNvY2tldE1lc3NhZ2UgPSB0aGlzLm9uU29ja2V0TWVzc2FnZS5iaW5kKHRoaXMpO1xyXG5cdFx0dGhpcy5vblNvY2tldE9wZW4gPSB0aGlzLm9uU29ja2V0T3Blbi5iaW5kKHRoaXMpO1xyXG5cclxuXHRcdHRoaXMuY29ubmVjdCgpO1xyXG5cdH1cclxuXHJcblx0cHVibGljIGFkZENyZWF0ZVZvdGVMaXN0ZW5lcihsaXN0ZW5lcjogVENoYW9zT3ZlcmxheUNsaWVudEV2ZW50KTogdm9pZCB7XHJcblx0XHR0aGlzLmNyZWF0ZUV2ZW50LmFkZEV2ZW50TGlzdGVuZXIobGlzdGVuZXIpO1xyXG5cdH1cclxuXHRwdWJsaWMgYWRkRW5kVm90ZUxpc3RlbmVyKGxpc3RlbmVyOiBUQ2hhb3NPdmVybGF5Q2xpZW50RXZlbnQpOiB2b2lkIHtcclxuXHRcdHRoaXMuZW5kRXZlbnQuYWRkRXZlbnRMaXN0ZW5lcihsaXN0ZW5lcik7XHJcblx0fVxyXG5cdHB1YmxpYyBhZGRVcGRhdGVWb3RlTGlzdGVuZXIobGlzdGVuZXI6IFRDaGFvc092ZXJsYXlDbGllbnRFdmVudCk6IHZvaWQge1xyXG5cdFx0dGhpcy51cGRhdGVFdmVudC5hZGRFdmVudExpc3RlbmVyKGxpc3RlbmVyKTtcclxuXHR9XHJcblx0cHVibGljIHJlbW92ZUNyZWF0ZVZvdGVMaXN0ZW5lcihsaXN0ZW5lcjogVENoYW9zT3ZlcmxheUNsaWVudEV2ZW50KTogdm9pZCB7XHJcblx0XHR0aGlzLmNyZWF0ZUV2ZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIobGlzdGVuZXIpO1xyXG5cdH1cclxuXHRwdWJsaWMgcmVtb3ZlRW5kVm90ZUxpc3RlbmVyKGxpc3RlbmVyOiBUQ2hhb3NPdmVybGF5Q2xpZW50RXZlbnQpOiB2b2lkIHtcclxuXHRcdHRoaXMuZW5kRXZlbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihsaXN0ZW5lcik7XHJcblx0fVxyXG5cdHB1YmxpYyByZW1vdmVVcGRhdGVWb3RlTGlzdGVuZXIobGlzdGVuZXI6IFRDaGFvc092ZXJsYXlDbGllbnRFdmVudCk6IHZvaWQge1xyXG5cdFx0dGhpcy51cGRhdGVFdmVudC5yZW1vdmVFdmVudExpc3RlbmVyKGxpc3RlbmVyKTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIENvbm5lY3RzIHRvIHRoZSB3ZWJzb2NrZXQgc2VydmVyIGFuZCBhZGRzIGV2ZW50IGxpc3RlbmVyc1xyXG5cdCAqL1xyXG5cdHByaXZhdGUgY29ubmVjdCgpOiB2b2lkIHtcclxuXHRcdHRyeSB7XHJcblx0XHRcdHRoaXMuV1MgPSBuZXcgV2ViU29ja2V0KHRoaXMuVVJMKTtcclxuXHRcdFx0dGhpcy5XUy5hZGRFdmVudExpc3RlbmVyKCdjbG9zZScsIHRoaXMub25Tb2NrZXRDbG9zZSk7XHJcblx0XHRcdC8vIFwiYXMgYW55XCIgaXMgcmVxdWlyZWQgYmVjYXVzZSB0eXBlc2NyaXB0IHRoaW5rcyB0aGF0IHRoZSB3ZWJzb2NrZXQgXCJvbkVycm9yXCJcclxuXHRcdFx0Ly8gaGFzIGFuIGV2ZW50LCBhbmQgbm90IGFuZCBlcnJvciBhcyBjYWxsYmFjayBkYXRhXHJcblx0XHRcdHRoaXMuV1MuYWRkRXZlbnRMaXN0ZW5lcignZXJyb3InLCB0aGlzLm9uU29ja2V0RXJyb3IgYXMgYW55KTtcclxuXHRcdFx0dGhpcy5XUy5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgdGhpcy5vblNvY2tldE1lc3NhZ2UpO1xyXG5cdFx0XHR0aGlzLldTLmFkZEV2ZW50TGlzdGVuZXIoJ29wZW4nLCB0aGlzLm9uU29ja2V0T3Blbik7XHJcblx0XHR9IGNhdGNoIChlKSB7XHJcblx0XHRcdC8vIElmIHRoZSB3ZWJzb2NrZXQgY29ubmVjdGlvbiBmYWlscyB3ZSBnZXQgYW4gZXJyb3IsXHJcblx0XHRcdC8vIHRoaXMgaXMgY2F1Z2h0IGJ5IHRoZSBcIm9uRXJyb3JcIiBjYWxsYmFja1xyXG5cdFx0fVxyXG5cdH1cclxuXHQvKipcclxuXHQgKiBDYWxsYmFjayBmb3IgdGhlIHdlYnNvY2tldCBjbGllbnQgLSBjYWxsZWQgb24gZXJyb3JzXHJcblx0ICogQHBhcmFtIGVycm9yIHdoYXQgd2VudCB3cm9uZ1xyXG5cdCAqL1xyXG5cdHByaXZhdGUgb25Tb2NrZXRFcnJvcihlcnJvcjogRXJyb3IpOiB2b2lkIHtcclxuXHRcdGNvbnNvbGUubG9nKGBlcnJvciBpbiBzb2NrZXQgb2NjdXJyZWQ6ICR7ZXJyb3IubWVzc2FnZX0uIGNsb3Npbmcgc29ja2V0YCk7XHJcblx0XHRpZiAodGhpcy5XUyAhPT0gbnVsbCkgdGhpcy5XUy5jbG9zZSgpO1xyXG5cdH1cclxuXHQvKipcclxuXHQgKiBDYWxsYmFjayBmb3IgdGhlIHdlYnNvY2tldCBjbGllbnQgLSBjYWxsZWQgb24gc29ja2V0IGNsb3NlXHJcblx0ICovXHJcblx0cHJpdmF0ZSBvblNvY2tldENsb3NlKCk6IHZvaWQge1xyXG5cdFx0Y29uc29sZS5sb2coYHNvY2tldCBjbG9zZWQsIHJlY29ubmVjdGluZyBpbiAke0NoYW9zT3ZlcmxheUNsaWVudC5SRUNPTk5FQ1RfSU5URVJWQUx9bXNgKTtcclxuXHJcblx0XHR3aW5kb3cuc2V0VGltZW91dCgoKSA9PiB0aGlzLmNvbm5lY3QoKSwgQ2hhb3NPdmVybGF5Q2xpZW50LlJFQ09OTkVDVF9JTlRFUlZBTCk7XHJcblx0fVxyXG5cdC8qKlxyXG5cdCAqIENhbGxiYWNrIGZvciB0aGUgd2Vic29ja2V0IGNsaWVudCAtIGNhbGxlZCB3aGVuIGEgbWVzc2FnZSBpcyByZWNlaXZlZFxyXG5cdCAqIEBwYXJhbSBtZXNzYWdlIG1lc3NhZ2UgdGhhdCB3YXMgcmVjZWl2ZWRcclxuXHQgKi9cclxuXHRwcml2YXRlIG9uU29ja2V0TWVzc2FnZShtZXNzYWdlOiBNZXNzYWdlRXZlbnQpOiB2b2lkIHtcclxuXHRcdHRyeSB7XHJcblx0XHRcdGNvbnN0IE1FU1NBR0U6IElDaGFvc092ZXJsYXlDbGllbnRNZXNzYWdlID0gSlNPTi5wYXJzZShtZXNzYWdlLmRhdGEpO1xyXG5cclxuXHRcdFx0aWYgKE1FU1NBR0UucmVxdWVzdCA9PT0gJ0NSRUFURScpIHRoaXMuY3JlYXRlRXZlbnQuZGlzcGF0Y2goTUVTU0FHRSk7XHJcblx0XHRcdGVsc2UgaWYgKE1FU1NBR0UucmVxdWVzdCA9PT0gJ1VQREFURScpIHRoaXMudXBkYXRlRXZlbnQuZGlzcGF0Y2goTUVTU0FHRSk7XHJcblx0XHRcdGVsc2UgaWYgKE1FU1NBR0UucmVxdWVzdCA9PT0gJ0VORCcpIHRoaXMuZW5kRXZlbnQuZGlzcGF0Y2goTUVTU0FHRSk7XHJcblx0XHRcdGVsc2UgY29uc29sZS53YXJuKGB1bmtub3duIHJlcXVlc3QgdHlwZTogJHtNRVNTQUdFLnJlcXVlc3R9YCk7XHJcblx0XHR9IGNhdGNoIChlKSB7XHJcblx0XHRcdGNvbnNvbGUuZXJyb3IoYGZhaWxlZCB0byBwYXJzZSBqc29uIGRhdGE6ICR7ZX1gKTtcclxuXHRcdH1cclxuXHR9XHJcblx0LyoqXHJcblx0ICogQ2FsbGJhY2sgZm9yIHRoZSB3ZWJzb2NrZXQgY2xpZW50IC0gY2FsbGVkIG9uIHNvY2tldCBvcGVuXHJcblx0ICovXHJcblx0cHJpdmF0ZSBvblNvY2tldE9wZW4oKTogdm9pZCB7XHJcblx0XHRjb25zb2xlLmxvZygnc3VjY2Vzc2Z1bGx5IGNvbm5lY3RlZCB0byB3ZWJzb2NrZXQnKTtcclxuXHR9XHJcbn1cclxuIiwiZXhwb3J0IGNsYXNzIEJhciB7XHJcblx0cHVibGljIHN0YXRpYyByZWFkb25seSBCQVJfV0lEVEggPSAzNTA7XHJcblx0cHVibGljIHN0YXRpYyByZWFkb25seSBCQVJfSEVJR0hUID0gMzA7XHJcblxyXG5cdHByaXZhdGUgYmFyOiBIVE1MRGl2RWxlbWVudDtcclxuXHRwcml2YXRlIGJhcldyYXBwZXI6IEhUTUxEaXZFbGVtZW50O1xyXG5cdHByaXZhdGUgbGFiZWxNYXRjaDogSFRNTFNwYW5FbGVtZW50O1xyXG5cdHByaXZhdGUgbGFiZWxUZXh0OiBIVE1MU3BhbkVsZW1lbnQ7XHJcblx0cHJpdmF0ZSBsYWJlbFZvdGVzOiBIVE1MU3BhbkVsZW1lbnQ7XHJcblx0cHJpdmF0ZSBsYWJlbFdyYXBwZXI6IEhUTUxEaXZFbGVtZW50O1xyXG5cclxuXHRwdWJsaWMgY29uc3RydWN0b3IobGFiZWw6IHN0cmluZywgdm90ZXM6IHN0cmluZykge1xyXG5cdFx0Ly8gQ3JlYXRlIERPTSBlbGVtZW50c1xyXG5cdFx0dGhpcy5iYXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuXHRcdHRoaXMuYmFyV3JhcHBlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG5cdFx0dGhpcy5sYWJlbE1hdGNoID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xyXG5cdFx0dGhpcy5sYWJlbFdyYXBwZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuXHRcdHRoaXMubGFiZWxUZXh0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xyXG5cdFx0dGhpcy5sYWJlbFZvdGVzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xyXG5cdFx0Ly8gQXNzaWduIGNsYXNzZXNcclxuXHRcdHRoaXMuYmFyLmNsYXNzTGlzdC5hZGQoJ2JhcicpO1xyXG5cdFx0dGhpcy5iYXJXcmFwcGVyLmNsYXNzTGlzdC5hZGQoJ2JhcldyYXBwZXInKTtcclxuXHRcdHRoaXMubGFiZWxXcmFwcGVyLmNsYXNzTGlzdC5hZGQoJ2xhYmVsV3JhcHBlcicpO1xyXG5cclxuXHRcdHRoaXMubWF0Y2hlcyA9IFtdO1xyXG5cdFx0Ly8gQXNzZW1ibGUgdGhlIGJhciBlbGVtZW50XHJcblx0XHR0aGlzLmxhYmVsV3JhcHBlci5hcHBlbmQodGhpcy5sYWJlbE1hdGNoLCB0aGlzLmxhYmVsVGV4dCwgdGhpcy5sYWJlbFZvdGVzKTtcclxuXHRcdHRoaXMuYmFyV3JhcHBlci5hcHBlbmQodGhpcy5sYWJlbFdyYXBwZXIpO1xyXG5cdFx0dGhpcy5iYXJXcmFwcGVyLmFwcGVuZCh0aGlzLmJhcik7XHJcblxyXG5cdFx0dGhpcy5iYXIuc3R5bGUuaGVpZ2h0ID0gYCR7QmFyLkJBUl9IRUlHSFR9cHhgO1xyXG5cdFx0dGhpcy5iYXJXcmFwcGVyLnN0eWxlLmhlaWdodCA9IGAke0Jhci5CQVJfSEVJR0hUfXB4YDtcclxuXHRcdHRoaXMuYmFyV3JhcHBlci5zdHlsZS53aWR0aCA9IGAke0Jhci5CQVJfV0lEVEh9cHhgO1xyXG5cclxuXHRcdC8vIFNldCB0aGUgbGFiZWwgY29udGVudFxyXG5cdFx0dGhpcy5sYWJlbCA9IGxhYmVsO1xyXG5cdFx0dGhpcy52b3RlcyA9IHZvdGVzO1xyXG5cdH1cclxuXHJcblx0cHVibGljIGdldEJhcldyYXBwZXIoKTogSFRNTERpdkVsZW1lbnQge1xyXG5cdFx0cmV0dXJuIHRoaXMuYmFyV3JhcHBlcjtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBzZXQgbGFiZWwobGFiZWw6IHN0cmluZykge1xyXG5cdFx0dGhpcy5sYWJlbFRleHQuaW5uZXJUZXh0ID0gbGFiZWw7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgc2V0IHZvdGVzKHZvdGVzOiBzdHJpbmcpIHtcclxuXHRcdHRoaXMubGFiZWxWb3Rlcy5pbm5lclRleHQgPSB2b3Rlcy50b1N0cmluZygpO1xyXG5cdH1cclxuXHJcblx0cHVibGljIHNldCBiYXJXaWR0aCh3aWR0aDogc3RyaW5nKSB7XHJcblx0XHR0aGlzLmJhci5zdHlsZS53aWR0aCA9IHdpZHRoO1xyXG5cdH1cclxuXHJcblx0cHVibGljIHNldCBtYXRjaGVzKG1hdGNoZXM6IHN0cmluZ1tdKSB7XHJcblx0XHR0aGlzLmxhYmVsTWF0Y2guaW5uZXJUZXh0ID0gbWF0Y2hlcy5qb2luKCcvJykgKyAnLic7XHJcblx0fVxyXG59XHJcbiIsImltcG9ydCB7IENoYW9zT3ZlcmxheUNsaWVudCB9IGZyb20gJy4vY2hhb3NPdmVybGF5Q2xpZW50L2NsaWVudCc7XHJcbmltcG9ydCB7IEJhciB9IGZyb20gJy4vYmFycyc7XHJcbmltcG9ydCB7IElDaGFvc092ZXJsYXlDbGllbnRNZXNzYWdlIH0gZnJvbSAnLi9jaGFvc092ZXJsYXlDbGllbnQvaU1lc3NhZ2UnO1xyXG5cclxubGV0IGJhcnM6IEJhcltdID0gW107XHJcbmxldCB0b3RhbFZvdGVzID0gMDtcclxuXHJcbi8vIEdldCBET00gZWxlbWVudHNcclxuY29uc3QgQkFSX0NPTlRBSU5FUiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdiYXJDb250YWluZXInKTtcclxuY29uc3QgVE9UQUxfVk9URVMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndG90YWxWb3RlcycpO1xyXG5cclxuY29uc3QgV1NfQ0xJRU5UID0gbmV3IENoYW9zT3ZlcmxheUNsaWVudCgnd3M6Ly9sb2NhbGhvc3Q6OTA5MScpO1xyXG5cclxuV1NfQ0xJRU5ULmFkZENyZWF0ZVZvdGVMaXN0ZW5lcihjcmVhdGVWb3RlKTtcclxuV1NfQ0xJRU5ULmFkZFVwZGF0ZVZvdGVMaXN0ZW5lcih1cGRhdGVWb3RlKTtcclxuV1NfQ0xJRU5ULmFkZEVuZFZvdGVMaXN0ZW5lcigoKSA9PiBjb25zb2xlLmxvZygndm90ZSBzaG91bGQgaGF2ZSBlbmRlZCcpKTtcclxuXHJcbmZ1bmN0aW9uIGNyZWF0ZVZvdGUobWVzc2FnZTogSUNoYW9zT3ZlcmxheUNsaWVudE1lc3NhZ2UpOiB2b2lkIHtcclxuXHQvLyBSZW1vdmUgb2xkIGJhcnMgZnJvbSBET01cclxuXHRiYXJzLmZvckVhY2goYmFyID0+IGJhci5nZXRCYXJXcmFwcGVyKCkucmVtb3ZlKCkpO1xyXG5cdC8vIFVwZGF0ZSBiYXJzXHJcblx0YmFycyA9IG1lc3NhZ2Uudm90ZU9wdGlvbnMubWFwKFxyXG5cdFx0dm90ZU9wdGlvbiA9PiBuZXcgQmFyKHZvdGVPcHRpb24ubGFiZWwsIHZvdGVPcHRpb24udmFsdWUudG9TdHJpbmcoKSlcclxuXHQpO1xyXG5cdHVwZGF0ZUJhckNvbnRhaW5lcigpO1xyXG5cdC8vIFVwZGF0ZSB0aGUgdG90YWwgdm90ZXMgY291bnRlclxyXG5cdHRvdGFsVm90ZXMgPSBtZXNzYWdlLnRvdGFsVm90ZXM7XHJcblx0dXBkYXRlVG90YWxWb3RlcygpO1xyXG59XHJcblxyXG5mdW5jdGlvbiB1cGRhdGVWb3RlKG1lc3NhZ2U6IElDaGFvc092ZXJsYXlDbGllbnRNZXNzYWdlKTogdm9pZCB7XHJcblx0Y29uc3QgeyB2b3RlT3B0aW9ucywgdG90YWxWb3RlczogbmV3VG90YWxWb3RlcyB9ID0gbWVzc2FnZTtcclxuXHQvLyBDaGVjayBpZiB0aGUgbGVuZ3RoIG9mIHRoZSB2b3RlIG9wdGlvbnMgaXMgdGhlIHNhbWUgYXMgdGhlIGJhciBhbW91bnQuXHJcblx0Ly8gSWYgbm90LCBhbiBlcnJvciBvY3VycmVkIGFuZCB3ZSBqdXN0IHRyZWF0IHRoZSB1cGRhdGUgYXMgY3JlYXRlXHJcblx0aWYgKGJhcnMubGVuZ3RoICE9PSB2b3RlT3B0aW9ucy5sZW5ndGgpIHtcclxuXHRcdGNvbnNvbGUuZXJyb3IoYGJhciBhbW91bnQgaXMgbm90IGVxdWFsIHRvIHZvdGUgb3B0aW9ucyBsZW5ndGgsIHRyZWF0aW5nIGFzIG5ldyB2b3RlYCk7XHJcblx0XHRjcmVhdGVWb3RlKG1lc3NhZ2UpO1xyXG5cdH0gZWxzZSB7XHJcblx0XHR2b3RlT3B0aW9ucy5mb3JFYWNoKCh2b3RlT3B0aW9uLCBpbmRleCkgPT4ge1xyXG5cdFx0XHRjb25zdCBiYXIgPSBiYXJzW2luZGV4XTtcclxuXHRcdFx0Y29uc3QgQkFSX1dJRFRIID0gbmV3VG90YWxWb3RlcyA+IDAgPyAoQmFyLkJBUl9XSURUSCAvIG5ld1RvdGFsVm90ZXMpICogdm90ZU9wdGlvbi52YWx1ZSA6IDA7XHJcblxyXG5cdFx0XHRpZiAobWVzc2FnZS52b3RpbmdNb2RlID09PSAnUEVSQ0VOVEFHRScpIHtcclxuXHRcdFx0XHRsZXQgYmFyVmFsdWU6IG51bWJlcjtcclxuXHRcdFx0XHQvLyBXZSBjYW4ndCBkaXZpZGUgYnkgdG90YWwgdm90ZXMgaWYgaXQgaXMgbnVsbFxyXG5cdFx0XHRcdGlmIChuZXdUb3RhbFZvdGVzID09PSAwKSBiYXJWYWx1ZSA9IDA7XHJcblx0XHRcdFx0ZWxzZSBiYXJWYWx1ZSA9IE1hdGguZmxvb3IoKHZvdGVPcHRpb24udmFsdWUgLyBuZXdUb3RhbFZvdGVzKSAqIDEwMCk7XHJcblx0XHRcdFx0YmFyLnZvdGVzID0gYCR7YmFyVmFsdWV9JWA7XHJcblx0XHRcdH0gZWxzZSBiYXIudm90ZXMgPSB2b3RlT3B0aW9uLnZhbHVlLnRvU3RyaW5nKCk7XHJcblxyXG5cdFx0XHRiYXIuYmFyV2lkdGggPSBgJHtCQVJfV0lEVEh9cHhgO1xyXG5cdFx0XHRiYXIubWF0Y2hlcyA9IHZvdGVPcHRpb24ubWF0Y2hlcztcclxuXHRcdH0pO1xyXG5cdFx0Ly8gVXBkYXRlIHRvdGFsIHZvdGVzXHJcblx0XHR0b3RhbFZvdGVzID0gbmV3VG90YWxWb3RlcztcclxuXHRcdHVwZGF0ZVRvdGFsVm90ZXMoKTtcclxuXHR9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHVwZGF0ZUJhckNvbnRhaW5lcigpOiB2b2lkIHtcclxuXHRpZiAoQkFSX0NPTlRBSU5FUiA9PT0gbnVsbCkgdGhyb3cgbmV3IEVycm9yKCdjb3VsZCBub3QgZmluZCBiYXIgY29udGFpbmVyIGluIERPTScpO1xyXG5cdEJBUl9DT05UQUlORVIuYXBwZW5kKC4uLmJhcnMubWFwKGJhciA9PiBiYXIuZ2V0QmFyV3JhcHBlcigpKSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHVwZGF0ZVRvdGFsVm90ZXMoKTogdm9pZCB7XHJcblx0aWYgKFRPVEFMX1ZPVEVTID09PSBudWxsKSB0aHJvdyBuZXcgRXJyb3IoJ2NvdWxkIG5vdCBmaW5kIHRvdGFsIHZvdGVzIGluIERPTScpO1xyXG5cdFRPVEFMX1ZPVEVTLmlubmVyVGV4dCA9IGBUb3RhbCBWb3RlczogJHt0b3RhbFZvdGVzLnRvU3RyaW5nKCl9YDtcclxufVxyXG4iXSwic291cmNlUm9vdCI6IiJ9